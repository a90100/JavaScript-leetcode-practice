# 2458. Height of Binary Tree After Subtree Removal Queries

## è§£é¡Œç¨‹å¼ç¢¼

```javascript
var treeQueries = function (root, queries) {
  const res = new Map();
  const nodeHeights = new Map();

  const calcHeight = (node) => {
    if (!node) return 0;

    nodeHeights.set(node.val, 1 + Math.max(calcHeight(node.left), calcHeight(node.right)));
    return nodeHeights.get(node.val);
  };
  calcHeight(root);

  const DFS = (node, curHeight, maxHeightWithoutCurNode) => {
    if (!node) return 0;
    res.set(node.val, maxHeightWithoutCurNode);

    DFS(node.left, curHeight + 1, Math.max(maxHeightWithoutCurNode, curHeight + (nodeHeights.get(node?.right?.val) ?? 0)));
    DFS(node.right, curHeight + 1, Math.max(maxHeightWithoutCurNode, curHeight + (nodeHeights.get(node?.left?.val) ?? 0)));
  };
  DFS(root, 0, 0);

  return queries.map((q) => res.get(q));
};
```

ç”¨ CHATGPT è½‰æ›ä»–äººè§£ç­”:

[ã€daydayUpppğŸˆã€‘æ€è·¯ä»£ç ç®€å•ï¼Œä¸¤æ¬¡dfs](https://leetcode.cn/problems/height-of-binary-tree-after-subtree-removal-queries/solutions/1938390/daydayuppp-jian-dan-si-lu-liang-ci-dfs-b-brso/)

```javascript
const N = 1e5 + 7; // ç­‰æ–¼ 100007
const mp1 = new Array(N).fill(0); // Maximum value from left to right to node i
const mp2 = new Array(N).fill(0); // Maximum value from right to left to node i
let maxHeight = 0; // Track maximum height

function dfs1(root, depth) {
  // Traverse left to right
  if (!root) return;
  mp1[root.val] = maxHeight;
  maxHeight = Math.max(maxHeight, depth);
  if (root.left) dfs1(root.left, depth + 1);
  if (root.right) dfs1(root.right, depth + 1);
}

function dfs2(root, depth) {
  // Traverse right to left
  if (!root) return;
  mp2[root.val] = maxHeight;
  maxHeight = Math.max(maxHeight, depth);
  if (root.right) dfs2(root.right, depth + 1);
  if (root.left) dfs2(root.left, depth + 1);
}

function treeQueries(root, queries) {
  maxHeight = 0;
  dfs1(root, 0);

  maxHeight = 0;
  dfs2(root, 0);

  const result = [];
  for (let i of queries) {
    result.push(Math.max(mp1[i], mp2[i]));
  }
  return result;
}
```

## è§£é¡Œæ€è·¯ã€æ¼”ç®—æ³•

æ±‚æ¨¹çš„é«˜åº¦ï¼Œé‚£å¯ä»¥å…ˆè·‘ DFS æ±‚å‡ºæ¯å€‹å­æ¨¹çš„é«˜åº¦ï¼Œ

ç¬¬äºŒæ¬¡åš DFS æ™‚ï¼Œè¦ç®—å‡ºåˆªé™¤ç•¶å‰éæ­·ç¯€é»å¾Œï¼Œæ•´å€‹æ¨¹çš„é«˜åº¦ï¼Œ

å¾ åˆªé™¤ç¯€é»å¾Œå‰©ä¸‹çš„æ¨¹é«˜åº¦ å’Œ æ ¹ç¯€é»åˆ°ç•¶å‰ç¯€é»çš„å·¦/å³å­æ¨¹é«˜åº¦ ä¸­å–æœ€å¤§å€¼ï¼Œå³ç‚ºåˆªé™¤ç•¶å‰éæ­·ç¯€é»å¾Œï¼Œæ•´å€‹æ¨¹çš„é«˜åº¦ã€‚

> å»æ‰ left å¾Œæ¨¹çš„é«˜åº¦ = max(å»æ‰ cur å¾Œæ¨¹çš„é«˜åº¦, right åˆ†æ”¯çš„æ·±åº¦)
> å»æ‰ right å¾Œæ¨¹çš„é«˜åº¦ = max(å»æ‰ cur å¾Œæ¨¹çš„é«˜åº¦, left åˆ†æ”¯çš„æ·±åº¦)

## è§£æ³•çš„æ™‚é–“ã€ç©ºé–“è¤‡é›œåº¦

æ™‚é–“è¤‡é›œåº¦: O(n)
ç©ºé–“è¤‡é›œåº¦: O(n)

## åƒè€ƒè³‡æ–™

[ä¸¤é DFSï¼ˆPython/Java/C++/Goï¼‰](https://leetcode.cn/problems/height-of-binary-tree-after-subtree-removal-queries/solutions/1936338/liang-bian-dfspythonjavacgo-by-endlessch-vvs4/)
