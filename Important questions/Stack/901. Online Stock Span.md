# 901. Online Stock Span

## 解題程式碼

```javascript
var StockSpanner = function () {
  this.stack = [];
};

/**
 * @param {number} price
 * @return {number}
 */
StockSpanner.prototype.next = function (price) {
  let span = 1;
  while (this.stack[this.stack.length - 1]?.price <= price) {
    span += this.stack.pop()?.span;
  }

  this.stack.push({ price, span });
  return span;
};
```

## 解題思路、演算法

可以參考 739 題，Monotonic Stack 的介紹筆記，這題使用到此演算法解題。我們除了記錄 price 到 stack 之外，還可以另外記錄當前 price 的 span，也就是該 price 比它的前面幾個 price 大的數量。下圖可以清楚表達概念。

![](https://upload.cc/i1/2024/03/17/CjWvux.png)

這樣做的好處就是可以減少和前面 price 比對的次數，例如如果碰到以下這種的測試資料，若一個個比對將會相當消耗時間，也會超過此題的時間限制。

```
[[],[1],[2],[2],[3],[4],[4],[5],[6],[7],[9],[9],[10],[10],[12],[15],[15],[16],[16],[17],[18],[19],[20],[20],[22],[22],[24],[24],[25],[26],[29],[30],[30],[31],[31],[32],[34],[34],[35],[35],[36],[37],[39],[42],[42],[42],[43],[43],[44],[45],[47],[48],[51],[52],[52],[56],[58],[59],[60],[61],[62],[63],[63],[63],[64],[65],[66],[66],[67],[67],[68],[68],[68],[69],[69],[71],[72],[74],[74],[76],[76],[76],[77],[77],[79],[80],[80],[81],[82],[84],[85],[88],[88],[90],[91],[91],[93],[93],[93],[94],[94],[95],[95],[96],[96],[96],[98],[98],[99],[99],[100],[102],[102],[102],[103],[107],[108],[109],[111],[113],[114],[114],[115],[115],[117],[117],[118],[118],[119],[121],[122],[122],[123],[123],[123],[124],[125],[125],[128],[128],[129],[129],[129],[131],[131],[132],[135],[135],[137],[137],[139],[139],[140],[140],[140],[141],[142],[144],[145],[146],[147],[147],[148],[148],[149],[152],[152],[153],[157],[157],[158],[159],[160],[161],[161],[163],[164],[165],[165],[166],[166],[168],[169],[169],[170],[170],[171],...
```

## 解法的時間、空間複雜度

時間複雜度: O(n)
空間複雜度: O(n)

## 參考資料
